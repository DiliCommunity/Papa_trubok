<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ü–∞–ø–∞ –¢—Ä—É–±–æ–∫ ‚Äî –ú–æ—è –∏–≥—Ä–∞</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <div class="container">
        <div class="papyrus">
            <div class="hieroglyph-border"></div>
            <div class="torn-edge top-edge"></div>
            <div class="torn-edge right-edge"></div>
            <div class="torn-edge bottom-edge"></div>
            <div class="torn-edge left-edge"></div>
            <div class="worn-spot spot1"></div>
            <div class="worn-spot spot2"></div>
            <div class="worn-spot spot3"></div>
            <div class="scarab top-left">ìÜ£</div>
            <div class="scarab top-right">ìÜ£</div>
            <div class="scarab bottom-left">ìÜ£</div>
            <div class="scarab bottom-right">ìÜ£</div>

            <div id="gameMain" style="display: block;">
                <div class="title">
                    <h1>–í–∞—à–∞ –∫–æ–º–Ω–∞—Ç–∞</h1>
                </div>
                <div class="game-room" id="gameRoom">
                    <div class="game-room-header">
                        <h2 class="game-room-title" id="gameRoomTitle">–ö–æ–º–Ω–∞—Ç–∞</h2>
                        <span class="game-room-status" id="gameRoomStatus">–û–∂–∏–¥–∞–Ω–∏–µ</span>
                    </div>
                    <div class="question-box">
                        <h3>–í–æ–ø—Ä–æ—Å:</h3>
                        <p class="question-text" id="gameQuestionText">‚Äî</p>
                    </div>
                    <div class="game-room-info">
                        <div class="game-room-players">
                            <span class="game-room-player" id="gameRoomPlayers">–ò–≥—Ä–æ–∫–æ–≤: 0/10</span>
                            <span class="game-room-player" id="gameRoomAnswers">–û—Ç–≤–µ—Ç–æ–≤: 0</span>
                        </div>
                    </div>
                    <div id="gameActions"></div>
                </div>
                <div id="userAnswerDisplay" style="display: none;"></div>
            </div>
        </div>
    </div>
    <script src="game.js"></script>
    <script src="userAnswer.js"></script>
    <script src="auth.js"></script>
    <script>
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã—Ö–æ–¥
        window.addEventListener('beforeunload', function(e) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞
            const gameId = new URLSearchParams(window.location.search).get('id');
            if (gameId) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –∏–≥—Ä—ã –ø–µ—Ä–µ–¥ —É—Ö–æ–¥–æ–º
                localStorage.setItem('papaTrubok_lastGameId', gameId);
            }
            
            // –û—Ç–º–µ–Ω—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
            e.preventDefault();
            e.returnValue = '';
        });

        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π ID –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', function() {
            const savedGameId = localStorage.getItem('papaTrubok_lastGameId');
            const currentGameId = new URLSearchParams(window.location.search).get('id');
            
            if (savedGameId && savedGameId !== currentGameId) {
                // –ï—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π ID –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è, –æ–±–Ω–æ–≤–ª—è–µ–º URL
                window.history.replaceState(null, '', `game.html?id=${savedGameId}`);
                location.reload();
            }
        });
    </script>
</body>
</html> 
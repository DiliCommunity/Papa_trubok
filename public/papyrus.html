<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>–ü–∞–ø–∞ –¢—Ä—É–±–æ–∫</title>
    <link rel="stylesheet" href="main.css">
    <link rel="stylesheet" href="styles.css">
    <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –æ—Ç–ª–æ–≤–∞ –æ—à–∏–±–æ–∫ JavaScript -->
    <script type="text/javascript">
      window.onerror = function(message, source, lineno, colno, error) {
        console.error("–û—à–∏–±–∫–∞ JavaScript:", message, "–≤", source, "—Å—Ç—Ä–æ–∫–∞:", lineno);
        
        // –í–º–µ—Å—Ç–æ –∫—Ä–∞—Å–Ω–æ–π –ø–∞–Ω–µ–ª–∏ —Å–≤–µ—Ä—Ö—É, –¥–æ–±–∞–≤–ª—è–µ–º –æ—à–∏–±–∫—É –≤ debugInfo, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        setTimeout(() => {
          const debugInfo = document.getElementById('debugInfo');
          if (debugInfo) {
            const errorDiv = document.createElement('div');
            errorDiv.style.color = 'red';
            errorDiv.style.margin = '5px 0';
            errorDiv.style.fontWeight = 'bold';
            errorDiv.innerHTML = `<strong>–û–®–ò–ë–ö–ê:</strong> ${message}<br>–§–∞–π–ª: ${source}<br>–°—Ç—Ä–æ–∫–∞: ${lineno}`;
            debugInfo.appendChild(errorDiv);
          }
        }, 100);
        
        return true; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞
      };
    </script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
</head>
<body>
    <div class="container">
        <div class="papyrus">
            <div class="hieroglyph-border"></div>
            
            <!-- –≠—Ñ—Ñ–µ–∫—Ç—ã –ø–æ—Ä–≤–∞–Ω–Ω—ã—Ö –∫—Ä–∞–µ–≤ -->
            <div class="torn-edge top-edge"></div>
            <div class="torn-edge right-edge"></div>
            <div class="torn-edge bottom-edge"></div>
            <div class="torn-edge left-edge"></div>
            
            <!-- –ü–æ—Ç–µ—Ä—Ç–æ—Å—Ç–∏ –Ω–∞ –ø–∞–ø–∏—Ä—É—Å–µ -->
            <div class="worn-spot spot1"></div>
            <div class="worn-spot spot2"></div>
            <div class="worn-spot spot3"></div>
            
            <div class="scarab top-left">ìÜ£</div>
            <div class="scarab top-right">ìÜ£</div>
            <div class="scarab bottom-left">ìÜ£</div>
            <div class="scarab bottom-right">ìÜ£</div>
            
            <!-- –≠–∫—Ä–∞–Ω –∑–∞–ø—É—Å–∫–∞ -->
            <div id="startScreen" style="display: block;">
                <div class="title">
                    <h1>PapaTrubok</h1>
                    <p>–î—Ä–µ–≤–Ω–µ–µ–≥–∏–ø–µ—Ç—Å–∫–∏–π —Å–≤–∏—Ç–æ–∫ —Å–º–µ—à–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤</p>
                </div>
                
                <div class="rules">
                    <h2>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
                    <ol>
                        <li>–ö–∞–∂–¥–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É –∑–∞–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å</li>
                        <li>–ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–π —Å–∞–º—ã–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç</li>
                        <li>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –Ω–∞—á–Ω—ë—Ç—Å—è –∫–æ–≥–¥–∞:
                            <ul>
                                <li>–ù–∞–±–µ—Ä—ë—Ç—Å—è 10 –æ—Ç–≤–µ—Ç–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)</li>
                                <li>–ò–õ–ò —Å–æ–∑–¥–∞—Ç–µ–ª—å –∏–≥—Ä—ã –Ω–∞–∂–º—ë—Ç –∫–Ω–æ–ø–∫—É –Ω–∞—á–∞–ª–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –º–∏–Ω–∏–º—É–º 3 –æ—Ç–≤–µ—Ç–æ–≤)</li>
                            </ul>
                        </li>
                        <li>–í –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏ –∫–∞–∂–¥—ã–π –≤—ã–±–∏—Ä–∞–µ—Ç 2 —Å–∞–º—ã—Ö —Å–º–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞ (–∫—Ä–æ–º–µ —Å–≤–æ–µ–≥–æ)</li>
                        <li>–ü–æ–±–µ–∂–¥–∞–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≥–æ–ª–æ—Å–æ–≤</li>
                    </ol>
                </div>
                
                <div class="button-group">
                    <button id="startAppBtn" class="papyrus-button shimmer">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ -->
            <div id="nameScreen" style="display: none;">
                <div class="title">
                    <h1>–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è, –ø—É—Ç–Ω–∏–∫!</h1>
                </div>
                
                <div class="input-area">
                    <div id="nameChoiceButtons" class="button-group">
                        <!-- –ö–Ω–æ–ø–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <div id="newNameSection" style="display: none;">
                        <p>–ü—Ä–∏–¥—É–º–∞–π –ø—Ä–∏–∫–æ–ª—å–Ω–æ–µ –∏–º—è, –∫–æ—Ç–æ—Ä–æ–µ —É–≤–∏–¥—è—Ç –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏:</p>
                        <div class="papyrus-scroll">
                            <input type="text" id="nameInput" class="answer-input" placeholder="–¢–≤–æ—ë –ø—Ä–∏–∫–æ–ª—å–Ω–æ–µ –∏–º—è..." maxlength="20">
                        </div>
                        <div class="button-group">
                            <button id="submitNameBtn" class="papyrus-button shimmer">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–º—è</button>
                            <button id="backToNameChoiceBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                        </div>
                    </div>
                    
                    <div id="existingNameSection" style="display: none;">
                        <p>–í—ã–±–µ—Ä–∏ –æ–¥–Ω–æ –∏–∑ —Ç–≤–æ–∏—Ö —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –∏–º—ë–Ω:</p>
                        <div id="savedNamesList" class="games-list"></div>
                        <div class="button-group">
                            <button id="backToNameChoiceFromExistingBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                        </div>
                    </div>
                    
                    <div class="button-group" id="mainNameScreenButtons">
                        <button id="backToStartBtn" class="papyrus-button shimmer back-button">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –Ω–∞—á–∞–ª–æ</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é/—Å–ø–∏—Å–∫–∞ –∏–≥—Ä -->
            <div id="gameScreen" style="display: none;">
                <div class="title">
                    <h1>–ö–æ–º–Ω–∞—Ç–∞ –∏–≥—Ä—ã</h1>
                </div>
                
                <div class="button-group">
                    <button id="createGameBtn" class="papyrus-button shimmer">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É</button>
                    <button id="refreshGamesBtn" class="papyrus-button shimmer">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä</button>
                </div>
                
                <div class="games-list-container">
                    <h2>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä—ã:</h2>
                    <div id="gamesList" class="games-list"></div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞ -->
            <div id="questionScreen" style="display: none;">
                <div class="title">
                    <h1>–ü—Ä–∏–¥—É–º–∞–π —Å–º–µ—à–Ω–æ–π –≤–æ–ø—Ä–æ—Å</h1>
                </div>
                
                <div class="input-area">
                    <p>–ù–∞–ø–∏—à–∏ –≤–æ–ø—Ä–æ—Å, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –∏–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å:</p>
                    <div class="papyrus-scroll">
                        <textarea id="questionInput" class="answer-input" placeholder="–¢–≤–æ–π –≤–æ–ø—Ä–æ—Å..." rows="4"></textarea>
                    </div>
                    <div class="button-group">
                        <button id="submitQuestionBtn" class="papyrus-button shimmer">–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É</button>
                        <button id="testCreateGameBtn" class="papyrus-button shimmer secondary-button">–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã</button>
                        <button id="backToMainFromQuestionBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å -->
            <div id="answerScreen" style="display: none;">
                <div class="title">
                    <h1>–î–∞–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç</h1>
                </div>
                
                <div class="question-box">
                    <div class="ancient-symbol left">ìÄÄ</div>
                    <div class="ancient-symbol right">ìÅπ</div>
                    <h3>–í–æ–ø—Ä–æ—Å:</h3>
                    <p class="question-text" id="answerQuestionText"></p>
                </div>
                
                <div class="input-area">
                    <p>–ù–∞–ø–∏—à–∏ —Å–∞–º—ã–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥—ë—Ç –≤ –≥–æ–ª–æ–≤—É:</p>
                    <div class="papyrus-scroll">
                        <textarea id="answerInput" class="answer-input" placeholder="–¢–≤–æ–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç..." rows="4"></textarea>
                    </div>
                    <div class="button-group">
                        <button id="submitAnswerBtn" class="papyrus-button shimmer">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç</button>
                        <button id="backToMainFromAnswerBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
            <div id="votingScreen" style="display: none;">
                <div class="title">
                    <h1>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</h1>
                </div>
                
                <div class="question-box">
                    <div class="ancient-symbol left">ìÄÄ</div>
                    <div class="ancient-symbol right">ìÅπ</div>
                    <h3>–í–æ–ø—Ä–æ—Å:</h3>
                    <p class="question-text" id="votingQuestionText"></p>
                </div>
                
                <div class="voting-area">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ 2 —Å–∞–º—ã—Ö —Å–º–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞ (–∫—Ä–æ–º–µ —Å–≤–æ–µ–≥–æ):</h3>
                    <div id="answerOptions" class="answer-options"></div>
                    <p id="votingStatus" class="status-text"></p>
                    <div class="button-group">
                        <button id="submitVotesBtn" class="papyrus-button shimmer">–ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å</button>
                        <button id="backToMainFromVotingBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="resultsScreen" style="display: none;">
                <div class="title">
                    <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h1>
                </div>
                
                <div class="question-box">
                    <div class="ancient-symbol left">ìÄÄ</div>
                    <div class="ancient-symbol right">ìÅπ</div>
                    <h3>–í–æ–ø—Ä–æ—Å:</h3>
                    <p class="question-text" id="resultsQuestionText"></p>
                </div>
                
                <div class="results-area">
                    <h3>–ò—Ç–æ–≥–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:</h3>
                    <div id="resultsList" class="results-list"></div>
                    <button id="backToMainBtn" class="papyrus-button shimmer">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –∫–æ–º–Ω–∞—Ç—ã –∏–≥—Ä—ã -->
            <div id="roomScreen" style="display: none;">
                <div class="title">
                    <h1 id="roomTitle">–ö–æ–º–Ω–∞—Ç–∞ –∏–≥—Ä—ã</h1>
                </div>
                
                <div class="question-box">
                    <div class="ancient-symbol left">ìÄÄ</div>
                    <div class="ancient-symbol right">ìÅπ</div>
                    <h3>–í–æ–ø—Ä–æ—Å:</h3>
                    <p class="question-text" id="roomQuestion"></p>
                    <div class="room-status">
                        <p>–°—Ç–∞—Ç—É—Å: <span id="roomStatus">–°–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤</span></p>
                        <p>–û—Ç–≤–µ—Ç–æ–≤: <span id="roomAnswersCount">0</span></p>
                        <p>–°–æ–∑–¥–∞—Ç–µ–ª—å: <span id="roomCreator">–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ</span></p>
                    </div>
                </div>
                
                <div id="userAnswerDisplay" style="display: none;">
                    <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                </div>
                
                <div class="room-actions">
                    <button id="answerButton" class="papyrus-button shimmer">–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å</button>
                    <button id="viewAnswersButton" class="papyrus-button shimmer" style="display: none;">–ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–≤–µ—Ç–æ–≤</button>
                    <button id="startVotingButton" class="papyrus-button shimmer creator-only" style="display: none;">–ù–∞—á–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</button>
                    <button id="leaveRoomButton" class="papyrus-button shimmer back-button">–ü–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                </div>
            </div>
        </div>
    </div>

    <!-- IndexedDB Storage -->
    <script src="indexedDB.js"></script>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script src="papyrus.js"></script>
    <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
    <script src="userAnswer.js"></script>
    <!-- –§—É–Ω–∫—Ü–∏–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
    <script src="auth.js"></script>
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞
        window.preventUnload = true;
        window.navigationHistory = [];

        // –§—É–Ω–∫—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞
        function safePageTransition(url, options = {}) {
            const {
                saveHistory = true,
                clearPreviousState = false,
                additionalData = null
            } = options;

            console.log(`–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥: ${url}`);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            if (window.currentGame && window.currentGame.id) {
                saveGameStateToIndexedDB(window.currentGame.id, window.currentGame);
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
            if (window.currentUser && window.currentUser.id) {
                saveUserToIndexedDB(window.currentUser);
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            if (additionalData) {
                saveAppStateToIndexedDB('transitionData', additionalData);
            }

            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è
            if (clearPreviousState) {
                localStorage.clear();
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞—Ä—à—Ä—É—Ç
            if (saveHistory) {
                window.navigationHistory.push(url);
                saveLastRoute(url);
            }

            // –†–∞–∑—Ä–µ—à–∞–µ–º –≤—ã—Ö–æ–¥
            window.preventUnload = false;

            // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            window.location.href = url;
        }

        // –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞–∑–∞–¥
        function goBack() {
            if (window.navigationHistory.length > 1) {
                window.navigationHistory.pop();
                const previousPage = window.navigationHistory[window.navigationHistory.length - 1];
                safePageTransition(previousPage, { saveHistory: false });
            } else {
                safePageTransition('index.html');
            }
        }

        // –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—ã—Ö–æ–¥–∞
        window.addEventListener('beforeunload', function(e) {
            if (window.preventUnload) {
                e.preventDefault();
                e.returnValue = '';
                return '';
            }
        });

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç
                const lastRoute = await getLastRoute();
                if (lastRoute && lastRoute !== window.location.href) {
                    console.log(`–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞: ${lastRoute}`);
                    safePageTransition(lastRoute, { saveHistory: false });
                    return;
                }

                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
                const savedGameId = localStorage.getItem('papaTrubok_lastGameId');
                if (savedGameId) {
                    const gameData = await getGameStateFromIndexedDB(savedGameId);
                    if (gameData) {
                        window.currentGame = gameData;
                        console.log('–°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è:', error);
            }
        });
    </script>
</body>
</html> 
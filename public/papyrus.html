<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PapaTrubok - –ò–≥—Ä–∞ –°–º–µ—à–Ω—ã—Ö –í–æ–ø—Ä–æ—Å–æ–≤</title>
    <link rel="stylesheet" href="main.css">
    <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –æ—Ç–ª–æ–≤–∞ –æ—à–∏–±–æ–∫ JavaScript -->
    <script type="text/javascript">
      window.onerror = function(message, source, lineno, colno, error) {
        console.error("–û—à–∏–±–∫–∞ JavaScript:", message, "–≤", source, "—Å—Ç—Ä–æ–∫–∞:", lineno);
        
        // –î–æ–±–∞–≤–∏–º –≤–∏–¥–∏–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        const errorDiv = document.createElement('div');
        errorDiv.style.position = 'fixed';
        errorDiv.style.top = '10px';
        errorDiv.style.left = '10px';
        errorDiv.style.right = '10px';
        errorDiv.style.backgroundColor = 'rgba(255, 0, 0, 0.8)';
        errorDiv.style.color = 'white';
        errorDiv.style.padding = '10px';
        errorDiv.style.zIndex = '9999';
        errorDiv.style.borderRadius = '5px';
        errorDiv.innerHTML = `<strong>–û—à–∏–±–∫–∞ JavaScript:</strong> ${message}<br>–§–∞–π–ª: ${source}<br>–°—Ç—Ä–æ–∫–∞: ${lineno}`;
        
        document.body.appendChild(errorDiv);
        return true; // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞
      };
    </script>
</head>
<body>
    <div class="container">
        <div class="papyrus">
            <div class="hieroglyph-border"></div>
            
            <!-- –≠—Ñ—Ñ–µ–∫—Ç—ã –ø–æ—Ä–≤–∞–Ω–Ω—ã—Ö –∫—Ä–∞–µ–≤ -->
            <div class="torn-edge top-edge"></div>
            <div class="torn-edge right-edge"></div>
            <div class="torn-edge bottom-edge"></div>
            <div class="torn-edge left-edge"></div>
            
            <!-- –ü–æ—Ç–µ—Ä—Ç–æ—Å—Ç–∏ –Ω–∞ –ø–∞–ø–∏—Ä—É—Å–µ -->
            <div class="worn-spot spot1"></div>
            <div class="worn-spot spot2"></div>
            <div class="worn-spot spot3"></div>
            
            <div class="scarab top-left">ìÜ£</div>
            <div class="scarab top-right">ìÜ£</div>
            <div class="scarab bottom-left">ìÜ£</div>
            <div class="scarab bottom-right">ìÜ£</div>
            
            <!-- –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–Ω–µ–ª—å -->
            <div id="debugPanel" style="position: fixed; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.8); color: white; padding: 10px; z-index: 10000; display: none;">
                <button onclick="this.parentNode.style.display='none'">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button onclick="clearAllData()">–°–±—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
                <button onclick="toggleScreens()">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã</button>
                <div id="debugInfo"></div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –∑–∞–ø—É—Å–∫–∞ -->
            <div id="startScreen" style="display: block;">
                <div class="title">
                    <h1>PapaTrubok</h1>
                    <p>–î—Ä–µ–≤–Ω–µ–µ–≥–∏–ø–µ—Ç—Å–∫–∏–π —Å–≤–∏—Ç–æ–∫ —Å–º–µ—à–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤</p>
                </div>
                
                <div class="rules">
                    <h2>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
                    <ol>
                        <li>–ö–∞–∂–¥–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É –∑–∞–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å</li>
                        <li>–ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–π —Å–∞–º—ã–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç</li>
                        <li>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –Ω–∞—á–Ω—ë—Ç—Å—è –∫–æ–≥–¥–∞:
                            <ul>
                                <li>–ù–∞–±–µ—Ä—ë—Ç—Å—è 10 –æ—Ç–≤–µ—Ç–æ–≤ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)</li>
                                <li>–ò–õ–ò —Å–æ–∑–¥–∞—Ç–µ–ª—å –∏–≥—Ä—ã –Ω–∞–∂–º—ë—Ç –∫–Ω–æ–ø–∫—É –Ω–∞—á–∞–ª–∞ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è</li>
                            </ul>
                        </li>
                        <li>–í –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏ –∫–∞–∂–¥—ã–π –≤—ã–±–∏—Ä–∞–µ—Ç 2 —Å–∞–º—ã—Ö —Å–º–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞ (–∫—Ä–æ–º–µ —Å–≤–æ–µ–≥–æ)</li>
                        <li>–ü–æ–±–µ–∂–¥–∞–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫ —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≥–æ–ª–æ—Å–æ–≤</li>
                    </ol>
                </div>
                
                <div class="button-group">
                    <button class="papyrus-button shimmer" onclick="startApp()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    <button class="papyrus-button" onclick="document.getElementById('debugPanel').style.display='block'">Debug</button>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ -->
            <div id="nameScreen" style="display: none;">
                <div class="title">
                    <h1>–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è, –ø—É—Ç–Ω–∏–∫!</h1>
                </div>
                
                <div class="input-area">
                    <p>–ü—Ä–∏–¥—É–º–∞–π –ø—Ä–∏–∫–æ–ª—å–Ω–æ–µ –∏–º—è, –∫–æ—Ç–æ—Ä–æ–µ —É–≤–∏–¥—è—Ç –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏:</p>
                    <div class="papyrus-scroll">
                        <input type="text" id="nameInput" class="answer-input" placeholder="–¢–≤–æ—ë –ø—Ä–∏–∫–æ–ª—å–Ω–æ–µ –∏–º—è..." maxlength="20">
                    </div>
                    <div class="button-group">
                        <button id="submitNameBtn" class="papyrus-button shimmer">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–º—è</button>
                        <button id="backToStartBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é/—Å–ø–∏—Å–∫–∞ –∏–≥—Ä -->
            <div id="gameScreen" style="display: none;">
                <div class="title">
                    <h1>–í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ</h1>
                </div>
                
                <div class="button-group">
                    <button id="createGameBtn" class="papyrus-button shimmer">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É</button>
                    <button id="refreshGamesBtn" class="papyrus-button shimmer">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä</button>
                </div>
                
                <div class="games-list-container">
                    <h2>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–≥—Ä—ã:</h2>
                    <div id="gamesList" class="games-list"></div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —Å–æ–∑–¥–∞–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞ -->
            <div id="questionScreen" style="display: none;">
                <div class="title">
                    <h1>–ü—Ä–∏–¥—É–º–∞–π —Å–º–µ—à–Ω–æ–π –≤–æ–ø—Ä–æ—Å</h1>
                </div>
                
                <div class="input-area">
                    <p>–ù–∞–ø–∏—à–∏ –≤–æ–ø—Ä–æ—Å, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –∏–≥—Ä–æ–∫–∏ –±—É–¥—É—Ç –æ—Ç–≤–µ—á–∞—Ç—å:</p>
                    <div class="papyrus-scroll">
                        <textarea id="questionInput" class="answer-input" placeholder="–¢–≤–æ–π –≤–æ–ø—Ä–æ—Å..." rows="4"></textarea>
                    </div>
                    <div class="button-group">
                        <button id="submitQuestionBtn" class="papyrus-button shimmer">–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É</button>
                        <button id="backToMainFromQuestionBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å -->
            <div id="answerScreen" style="display: none;">
                <div class="title">
                    <h1>–î–∞–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç</h1>
                </div>
                
                <div class="question-box">
                    <div class="ancient-symbol left">ìÄÄ</div>
                    <div class="ancient-symbol right">ìÅπ</div>
                    <h3>–í–æ–ø—Ä–æ—Å:</h3>
                    <p class="question-text" id="answerQuestionText"></p>
                </div>
                
                <div class="input-area">
                    <p>–ù–∞–ø–∏—à–∏ —Å–∞–º—ã–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–¥—ë—Ç –≤ –≥–æ–ª–æ–≤—É:</p>
                    <div class="papyrus-scroll">
                        <textarea id="answerInput" class="answer-input" placeholder="–¢–≤–æ–π —Å–º–µ—à–Ω–æ–π –æ—Ç–≤–µ—Ç..." rows="4"></textarea>
                    </div>
                    <div class="button-group">
                        <button id="submitAnswerBtn" class="papyrus-button shimmer">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç</button>
                        <button id="backToMainFromAnswerBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è -->
            <div id="votingScreen" style="display: none;">
                <div class="title">
                    <h1>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</h1>
                </div>
                
                <div class="question-box">
                    <div class="ancient-symbol left">ìÄÄ</div>
                    <div class="ancient-symbol right">ìÅπ</div>
                    <h3>–í–æ–ø—Ä–æ—Å:</h3>
                    <p class="question-text" id="votingQuestionText"></p>
                </div>
                
                <div class="voting-area">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ 2 —Å–∞–º—ã—Ö —Å–º–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–∞ (–∫—Ä–æ–º–µ —Å–≤–æ–µ–≥–æ):</h3>
                    <div id="answerOptions" class="answer-options"></div>
                    <p id="votingStatus" class="status-text"></p>
                    <div class="button-group">
                        <button id="submitVotesBtn" class="papyrus-button shimmer">–ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å</button>
                        <button id="backToMainFromVotingBtn" class="papyrus-button shimmer back-button">–ù–∞–∑–∞–¥</button>
                    </div>
                </div>
            </div>
            
            <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="resultsScreen" style="display: none;">
                <div class="title">
                    <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h1>
                </div>
                
                <div class="question-box">
                    <div class="ancient-symbol left">ìÄÄ</div>
                    <div class="ancient-symbol right">ìÅπ</div>
                    <h3>–í–æ–ø—Ä–æ—Å:</h3>
                    <p class="question-text" id="resultsQuestionText"></p>
                </div>
                
                <div class="results-area">
                    <h3>–ò—Ç–æ–≥–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è:</h3>
                    <div id="resultsList" class="results-list"></div>
                    <button id="backToMainBtn" class="papyrus-button shimmer">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ -->
    <script>
        // –ü–æ–ª–∏—Ñ–∏–ª–ª –¥–ª—è IE
        if (!window.location.origin) {
          window.location.origin = window.location.protocol + "//" + window.location.hostname + (window.location.port ? ':' + window.location.port: '');
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        function clearAllData() {
            try {
                localStorage.clear();
                sessionStorage.clear();
                console.log('–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
                alert('–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã');
            } catch(e) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö:', e);
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        function toggleScreens() {
            const screens = document.querySelectorAll('#startScreen, #nameScreen, #gameScreen, #questionScreen, #answerScreen, #votingScreen, #resultsScreen');
            const visibleScreens = Array.from(screens).filter(s => s.style.display !== 'none');
            
            if (visibleScreens.length === screens.length) {
                // –ï—Å–ª–∏ –ø–æ–∫–∞–∑–∞–Ω—ã –≤—Å–µ —ç–∫—Ä–∞–Ω—ã, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π
                screens.forEach(s => s.style.display = 'none');
                document.getElementById('startScreen').style.display = 'block';
            } else {
                // –ò–Ω–∞—á–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ
                screens.forEach(s => s.style.display = 'block');
            }
        }
        
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console.error –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–Ω–µ–ª–∏
        const originalConsoleError = console.error;
        console.error = function() {
            originalConsoleError.apply(console, arguments);
            const debugInfo = document.getElementById('debugInfo');
            if (debugInfo) {
                const errorMsg = Array.from(arguments).join(' ');
                const errorDiv = document.createElement('div');
                errorDiv.style.color = 'red';
                errorDiv.style.margin = '5px 0';
                errorDiv.textContent = `ERROR: ${errorMsg}`;
                debugInfo.appendChild(errorDiv);
            }
        };
        
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console.log –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–Ω–µ–ª–∏
        const originalConsoleLog = console.log;
        console.log = function() {
            originalConsoleLog.apply(console, arguments);
            const debugInfo = document.getElementById('debugInfo');
            if (debugInfo) {
                const logMsg = Array.from(arguments).join(' ');
                const logDiv = document.createElement('div');
                logDiv.style.color = 'lightgreen';
                logDiv.style.margin = '2px 0';
                logDiv.textContent = `LOG: ${logMsg}`;
                debugInfo.appendChild(logDiv);
            }
        };
        
        // –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–º–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
        if (!window.startAppOriginal) {
            window.startAppOriginal = window.startApp;
            window.startApp = function() {
                console.log('–í–´–ó–û–í: startApp()');
                try {
                    if (window.startAppOriginal) {
                        return window.startAppOriginal();
                    } else {
                        const nameScreen = document.getElementById('nameScreen');
                        if (nameScreen) {
                            document.getElementById('startScreen').style.display = 'none';
                            nameScreen.style.display = 'block';
                            console.log('–ü–æ–∫–∞–∑–∞–Ω —ç–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏');
                        } else {
                            console.error('–≠–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω');
                        }
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –≤ startApp:', e);
                }
            };
        }
        
        // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∑–∞–ø—É—Å–∫–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            const elements = [
                'startScreen', 'nameScreen', 'gameScreen', 'questionScreen', 
                'answerScreen', 'votingScreen', 'resultsScreen', 'nameInput', 
                'submitNameBtn'
            ];
            
            elements.forEach(id => {
                const el = document.getElementById(id);
                console.log(`–≠–ª–µ–º–µ–Ω—Ç #${id}: ${el ? '–ù–ê–ô–î–ï–ù' : '–ù–ï –ù–ê–ô–î–ï–ù'}`);
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å–∫—Ä–∏–ø—Ç–∞
            console.log(`–°–∫—Ä–∏–ø—Ç papyrus.js ${typeof window.startAppOriginal !== 'undefined' ? '–∑–∞–≥—Ä—É–∂–µ–Ω' : '–ù–ï –∑–∞–≥—Ä—É–∂–µ–Ω'}`);
        });
    </script>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script src="papyrus.js"></script>
</body>
</html> 